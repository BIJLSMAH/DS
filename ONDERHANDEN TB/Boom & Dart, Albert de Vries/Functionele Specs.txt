Goedemiddag Hessel,


Naar aanleiding van ons telefoongesprek het volgende:
Graag willen wij twee bestanden samenvoegen.


Bijgevoegd vind je drie bestanden.
De cultivars die wel in het bestand “Bomenlijst namen” voorkomen en niet in het bestand “Catalogus 2017 bomen” willen wij graag toevoegen aan dat bestand.
Daarbij willen wij dan van de duurste cultivar (1e, 2e en 3e naam) die van deze soort (1e en 2e naam) wel in het bestand catalogus 2017 bomen voorkomt de maten met bijbehorende prijzen overnemen.

In het nieuwe bestand “Catalogus 2017 bomen met uitbreiding” heb ik een voorbeeld gemaakt:

Bij Acer campestre.
Cultivar Any Globes komt niet voor, deze toegevoegd en alle maten en prijzen toegevoegd van Acer campestre Royal Ruby, want van Acer campestre “x” is Royal Ruby de duurste variant.
De ingevoegde regels graag de naam groen kleuren zoals in voorbeeld.
Daarnaast willen wij achter Any Globes graag een controle kolom hebben om zo handmatig snel te kunnen controleren waar de prijs vandaan komt.
_______________________

Ik zou nog terugkomen op het verhaal m.b.t. de Malus. Of ook wel de uitzonderingen:
De plant met twee namen, waarvan de tweede naam tussen aanhalingstekens staat (‘x’) wordt de prijs als “onbekend” geprojecteerd. Deze passen wij laten handmatig aan.
Graag deze regels een afwijkende kleur geven.
Voor deze planten (m.b.t. schrijfwijze) graag de volgende maten toevoegen:
14- 16 draadkluit hoogstam
14- 16 wortelgoed hoogstam
16- 18 draadkluit hoogstam
16- 18 wortelgoed hoogstam
18- 20 draadkluit hoogstam
18- 20 wortelgoed hoogstam
	
Voor het overige geldt het volgende, zoals gisteren ook telefonisch besproken:
Zoeken in de maat 16-18 draadkluit hoogstam en dan van de hele cultivar alle maten kopiëren en projecteren bij de nieuw in te voegen cultivar.
Als 16-18 draadkluit hoogstam als maat niet bestaat, dan zoeken in 14-16 draadkluit hoogstam.

Mocht deze ook niet bestaan dan prijs aanduiden met “onbekend”.

Uitgangspunten
_______________________

Als binnen een groep niet alle cultivars, maar slechts één of twee in de groep de maat 16-18 draadkluit hoogstam heeft betekent dit dat alleen deze betrokken word(t)en bij het bepalen van de hoogste prijs en de rest niet. 

Er wordt nu gecontroleerd bij het bepalen van de duurste cultivar in de groep van maat 16-18 DHO. Als er meerdere cultivars in de groep voorkomen met dezelfde prijs, dan wordt uitgegaan van de eerste. Er wordt 
op dat moment niet gekeken vergeleken op andere prijsverschillen van andere maatkodes.

Er is een voorwaardelijke opmaak gedefinieerd voor kolom D in de Catalogus. Als er in dezelfde regel in de kolom Opmerkingen iets zal zijn of worden ingevuld, zal de waarde kolom D groen worden gekleurd.
De cel zal omkaderd zijn.

Voor het toevoegen wordt het filter die eventueel op de cataloguslijst staat gewist, zodat alle regels worden getoond. Dit om eventueel ongewenste lege regels te voorkomen.
Uiteindelijk wordt na het toevoegen van de nieuwe namen uit de bomenlijst, de catalogus gesorteerd op groepnaam, binnen de groep op latijnse naam en binnen latijnse naam op maatkode omschrijving.

Werkwijze.
1. Doorloop de bomenlijst.
2. 		Bekijk per regel in de bomenlijst de samenstelling van de latijnse naam. Bekijk de eerste twee woorden van de bomenlijst.
3a.			Kijk of het tweede woord begint met een enkele quote "'". Er wordt alleen gecontroleerd op beginnende quote omdat er in de string soms spaties voorkomen Bijvoorbeeld Malus 'Donald Wyman'
			Als dit het geval is, voeg de cultivar toe en maak hieronder standaard maatkodes waarbij de prijs "onbekend"
3b.			Als van de latijnse naam het tweede woord niet begint met een enkele quote "'" of de latijnse naam bevat drie of meer woorden. 
			Als dit het geval is, bepaal dan op basis van de eerste twee woorden de groepnaam waarvan maat 16-18 cm. met draadkluit hoogstam de hoogste prijs laat zien.
				Als er op basis van de eerste en tweede naam geen groepnaam uit de catalogus kan worden bepaald, voeg de cultivar (latijnse naam) dan aan de catalogus toe met de standaard maatkodes en prijs onbekend.
				Als er meerdere cultivars zijn die onder dezelfde groep onder maat 16-18 cm. met draadkluit hoogstam dezelfde hoogste prijs hebben wordt er maar één als duurste aangewezen. Niet gekeken naar andere maten.
				Als er onder de groepnaam (eerste en tweede naam) geen enkele maatkode 16-18 cm. met draadkluit hoogstam voorkomt, kijk dan naar de maatkode 14-16 cm. met draadkluit hoogstam.
				Als er onder de groepnaam (eerste en tweede naam) geen enkele maatkode 16-18 cm. met draadkluit hoogstam en geen enkele 14-16 cm. met draadkluit hoogstam, voeg cultivar toe met standaard maatkodes en prijs onbekend.
				
N.B. Er wordt alleen gekeken naar de latijnse naam. Als in de bomenlijst een cultivar staat die wel als laanboom is opgenomen wordt deze niet onder fruit en vruchtbomen nog een keer aangemaakt. Een cultivar kan dus maar tot
één groep behoren. VB Crataegus lavalleei wordt aangeleverd in de bomenlijst als Fruit en Vruchtboom, maar staat in de catalogus al onder laanboom. Deze cultivar wordt nu niet nog eens aan de catalogus toegevoegd. 
 

________________________



Cultivar, definitie
Een cultivar is een plant of een plantengroep die geselecteerd is op wenselijke eigenschappen waarvan het behoud mogelijk is door teelt of andere vormen van vermeerdering.



Te realiseren functionaliteit
Stap 1. Selectie bestand Bomenlijst namen
Stap 2. Controle op juiste vorm en inhoud voor verwerking
Stap 3. Definieren Klasse BomenlijstNamen inclusief rijaanduiding in lijst
Stap 4. Definieren Klasse CatalogusBomen inclusief rijaanduiding in lijst
Stap 5. Definieren Klasse DuurstePerSoort (1e en 2e naam) inclusief prijs uit CatalogusBomen ook alle maten van de betreffende duurste variant overnemen.
		Gebruik hiervoor het rijbereik (cijfers) leg ook de groepnaam vast en de oorspronkelijk variant van de groep.
		Als van de betreffende variant nog geen soort aanwezig is, dan wordt de regel overgenomen, maar met maatcode onbekend en prijs onbekend.
Stap 3. Inlezen Bomenlijst Namen in Collectie van 
Stap 4. Inlezen Catalogus Bomen in Collectie
Stap 5. Doorloop Bomenlijst 
Stap 5a. Als BomenlijstNaam in Catalogus bestaat, dan ga naar de volgende.
Stap 5b. Als BomenlijstNaam niet in Catalogus bestaat, voeg deze dan onderaan de lijst toe. 
Stap 5c. Maak bij het toevoegen van de bomenlijstnamen onderaan gebruik van de klasse duurste per soort.